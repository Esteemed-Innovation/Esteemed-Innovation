package eiteam.esteemedinnovation.armor.exosuit.steam.upgrades;

import eiteam.esteemedinnovation.api.ChargableUtility;
import eiteam.esteemedinnovation.api.exosuit.ExosuitSlot;
import eiteam.esteemedinnovation.armor.ArmorModule;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.inventory.EntityEquipmentSlot;
import net.minecraft.item.ItemStack;
import net.minecraft.util.math.Vec3d;
import net.minecraftforge.event.entity.living.LivingEvent;

import javax.annotation.Nonnull;

import static eiteam.esteemedinnovation.armor.ArmorModule.resource;

public class ItemLeapActuatorUpgrade extends ItemSteamExosuitUpgrade {
    public ItemLeapActuatorUpgrade() {
        super(ExosuitSlot.BOOTS_TOP, resource("jump_upgrade"), null, 0);
    }

    @Override
    public void onPlayerJump(LivingEvent.LivingJumpEvent event, EntityPlayer jumper, @Nonnull ItemStack armorStack, EntityEquipmentSlot slot) {
        boolean shiftJump = jumper.isSneaking() && ChargableUtility.hasPower(jumper, ArmorModule.jumpBoostConsumptionShiftJump);

        if (shiftJump || ChargableUtility.hasPower(jumper, ArmorModule.jumpBoostConsumption)) {
            if (shiftJump) {
                Vec3d vector = jumper.getLook(0.5F);
                double total = Math.abs(vector.z + vector.x);
                double y = vector.y < total ? total : vector.y;

                jumper.motionY += (y) / 1.5F;
                jumper.motionZ += vector.z * 2;
                jumper.motionX += vector.x * 2;
                ChargableUtility.drainSteam(jumper.getItemStackFromSlot(EntityEquipmentSlot.CHEST), ArmorModule.jumpBoostConsumptionShiftJump, jumper);
            } else {
                ChargableUtility.drainSteam(jumper.getItemStackFromSlot(EntityEquipmentSlot.CHEST), ArmorModule.jumpBoostConsumption, jumper);
                jumper.motionY += 0.2750000059604645D;
            }
        }
    }
}
